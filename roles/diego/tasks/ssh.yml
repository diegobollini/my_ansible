---
- name: SSH - Key y config
  tags: ssh
  block:
    - name: SSH - Crear directorios si no existen
      become: true
      file:
        path: "{{ item }}"
        state: directory
      with_items:
        - "/home/{{ lookup('env','USER') }}/.ssh"
        - "/home/{{ lookup('env','USER') }}/.ssh/config"

    - name: SSH - Copiar llave p√∫blica
      copy:
        src: ./files/private_key_diego.pub
        dest: /home/{{ lookup('env','USER') }}/.ssh/private_key_diego.pub
        owner: "{{ lookup('env','USER') }}"
        group: "{{ lookup('env','USER') }}"
        mode: 744

    - name: SSH - Copiar configuraciones de sshconfig
      copy:
        src: ./files/ssh_config
        dest: /home/{{ lookup('env','USER') }}/.ssh/config
        owner: "{{ lookup('env','USER') }}"
        group: "{{ lookup('env','USER') }}"
        mode: 744
